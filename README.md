# ğŸ™ï¸ Whisper Voice Notes

**é«˜æ€§èƒ½æœ¬åœ°èªéŸ³è½‰æ–‡å­— Flutter æ‡‰ç”¨**

ä½¿ç”¨æœ€æ–°çš„ whisper.cpp å¯¦ç¾**æ¯«ç§’ç´š**ä¸­æ–‡èªéŸ³è­˜åˆ¥ï¼Œå®Œå…¨é›¢ç·šé‹è¡Œï¼Œä¿è­·éš±ç§ã€‚

## âœ¨ ä¸»è¦ç‰¹è‰²

### ğŸš€ æ¥µè‡´æ€§èƒ½
- **âš¡ æ¯«ç§’ç´šè½‰éŒ„**ï¼š3ç§’éŸ³é »åƒ…éœ€1ç§’è™•ç†æ™‚é–“
- **ğŸ”¥ å¯¦æ™‚æ€§èƒ½**ï¼šè½‰éŒ„é€Ÿåº¦æ¯”éŸ³é »æ’­æ”¾å¿«3å€
- **ğŸ“± ç¡¬é«”å„ªåŒ–**ï¼šæ™ºèƒ½æª¢æ¸¬ä¸¦ä½¿ç”¨ ARM64 FP16 / NEON VFPv4 å„ªåŒ–

### ğŸŒ èªè¨€æ”¯æ´
- **ğŸ‡¨ğŸ‡³ ä¸­æ–‡å„ªåŒ–**ï¼šé‡å°ä¸­æ–‡èªéŸ³è­˜åˆ¥èª¿å„ª
- **ğŸŒ å¤šèªè¨€**ï¼šæ”¯æ´ whisper.cpp çš„æ‰€æœ‰èªè¨€
- **ğŸ”„ è‡ªå‹•æª¢æ¸¬**ï¼šæ™ºèƒ½èªè¨€è­˜åˆ¥

### ğŸ”’ éš±ç§å®‰å…¨
- **ğŸ“± å®Œå…¨é›¢ç·š**ï¼šæ‰€æœ‰è™•ç†åœ¨æœ¬åœ°é€²è¡Œ
- **ğŸš« ç„¡ç¶²è·¯éœ€æ±‚**ï¼šä¸ä¸Šå‚³ä»»ä½•éŸ³é »æ•¸æ“š
- **ğŸ” æ•¸æ“šå®‰å…¨**ï¼šéŸ³é »æ–‡ä»¶åƒ…å­˜å„²åœ¨è¨­å‚™æœ¬åœ°

### ğŸ› ï¸ æŠ€è¡“ç‰¹è‰²
- **ğŸ“Š è©³ç´°çµ±è¨ˆ**ï¼šå¯¦æ™‚æ€§èƒ½ç›£æ§å’Œè¨ˆæ™‚è¿½è¹¤
- **ğŸ¯ æ™ºèƒ½å„ªåŒ–**ï¼šæ ¹æ“šè¨­å‚™è‡ªå‹•é¸æ“‡æœ€ä½³é…ç½®
- **ğŸ”§ å¤šç‰ˆæœ¬ç·¨è­¯**ï¼šé‡å°ä¸åŒ CPU æ¶æ§‹çš„å„ªåŒ–ç‰ˆæœ¬

## ğŸ† æ€§èƒ½è¡¨ç¾

### å¯¦æ¸¬çµæœï¼ˆPixel 8 Proï¼‰
```
éŸ³é »æ™‚é•·: 3.12ç§’
è½‰éŒ„è€—æ™‚: 1.02ç§’
è™•ç†é€Ÿåº¦: 3.06x å¯¦æ™‚
æº–ç¢ºç‡: é«˜ï¼ˆä¸­æ–‡èªéŸ³ï¼‰
```

### æ€§èƒ½å°æ¯”
| ç‰ˆæœ¬ | è½‰éŒ„æ™‚é–“ | æ€§èƒ½æå‡ |
|------|----------|----------|
| Debug | 35-71ç§’ | åŸºæº– |
| Release | **1ç§’** | **35-70å€** |

## ğŸš€ å¿«é€Ÿé–‹å§‹

### ç’°å¢ƒè¦æ±‚
- **Flutter**: 3.0+
- **Android**: API 23+ (Android 6.0+)
- **NDK**: 27.0.12077973
- **è¨­å‚™**: ARM64 æˆ– ARMv7 è™•ç†å™¨

### å®‰è£æ­¥é©Ÿ

1. **å…‹éš†å°ˆæ¡ˆ**
```bash
git clone https://github.com/yourusername/whisper_voice_notes.git
cd whisper_voice_notes
```

2. **åˆå§‹åŒ–å­æ¨¡çµ„**
```bash
git submodule update --init --recursive
```

3. **å®‰è£ä¾è³´**
```bash
flutter pub get
```

4. **æ§‹å»ºä¸¦é‹è¡Œ**
```bash
# Debug ç‰ˆæœ¬ï¼ˆé–‹ç™¼ç”¨ï¼‰
flutter run

# Release ç‰ˆæœ¬ï¼ˆæœ€ä½³æ€§èƒ½ï¼‰
flutter build apk --release
flutter install
```

## ğŸ“ å°ˆæ¡ˆçµæ§‹

```
whisper_voice_notes/
â”œâ”€â”€ lib/                          # Flutter æ‡‰ç”¨ç¨‹å¼ç¢¼
â”‚   â”œâ”€â”€ main.dart                 # æ‡‰ç”¨å…¥å£
â”‚   â””â”€â”€ pages/
â”‚       â””â”€â”€ voice_recorder_page.dart  # ä¸»è¦éŒ„éŸ³è½‰éŒ„é é¢
â”œâ”€â”€ android/
â”‚   â””â”€â”€ app/src/main/
â”‚       â”œâ”€â”€ cpp/                  # C++ Native ç¨‹å¼ç¢¼
â”‚       â”‚   â”œâ”€â”€ CMakeLists.txt    # æ§‹å»ºé…ç½®
â”‚       â”‚   â””â”€â”€ native-lib.cpp    # JNI æ¥å£å¯¦ç¾
â”‚       â””â”€â”€ kotlin/               # Android Kotlin ç¨‹å¼ç¢¼
â”‚           â””â”€â”€ MainActivity.kt   # ä¸» Activity
â”œâ”€â”€ assets/models/                # Whisper æ¨¡å‹æª”æ¡ˆ
â”‚   â”œâ”€â”€ ggml-tiny-q5_1.bin       # Tiny æ¨¡å‹ï¼ˆ32MBï¼Œæ¨è–¦ï¼‰
â”‚   â””â”€â”€ ggml-base-q5_1.bin       # Base æ¨¡å‹ï¼ˆ60MBï¼‰
â””â”€â”€ third_party/whisper.cpp/     # Whisper.cpp å­æ¨¡çµ„
```

## ğŸ”§ æŠ€è¡“æ¶æ§‹

### æ ¸å¿ƒçµ„ä»¶
- **Flutter Frontend**: ç¾ä»£åŒ– UI å’Œç”¨æˆ¶äº¤äº’
- **Kotlin Bridge**: Android å¹³å°æ•´åˆå’Œå”ç¨‹è™•ç†
- **C++ Engine**: whisper.cpp æ ¸å¿ƒå¼•æ“
- **JNI Interface**: é«˜æ•ˆçš„ Native èª¿ç”¨

### æ™ºèƒ½å„ªåŒ–
```cpp
// è‡ªå‹•é¸æ“‡æœ€ä½³ Native Library
if (CPU_supports_FP16) {
    load("whisper_v8fp16_va")  // ARM64 FP16 å„ªåŒ–
} else if (CPU_supports_NEON) {
    load("whisper_vfpv4")      // ARMv7 NEON å„ªåŒ–
} else {
    load("whisper")            // é€šç”¨ç‰ˆæœ¬
}
```

### æ€§èƒ½å„ªåŒ–ç­–ç•¥
1. **ç·¨è­¯æ™‚å„ªåŒ–**: `-O3` å„ªåŒ–ã€å‡½æ•¸å…§è¯ã€å‘é‡åŒ–
2. **é‹è¡Œæ™‚å„ªåŒ–**: æ™ºèƒ½åŸ·è¡Œç·’åˆ†é…ã€è¨˜æ†¶é«”æ± ç®¡ç†
3. **æ¨¡å‹å„ªåŒ–**: é‡åŒ–æ¨¡å‹ï¼ˆQ5_1ï¼‰æ¸›å°‘è¨˜æ†¶é«”ä½”ç”¨
4. **æ¶æ§‹å„ªåŒ–**: å¤šç‰ˆæœ¬ Native Library æ”¯æ´

## ğŸ“Š ä½¿ç”¨èªªæ˜

### åŸºæœ¬æ“ä½œ
1. **è¼‰å…¥æ¨¡å‹**: é¦–æ¬¡ä½¿ç”¨æ™‚è‡ªå‹•å¾ assets è¤‡è£½æ¨¡å‹
2. **éŒ„è£½éŸ³é »**: é»æ“ŠéŒ„éŸ³æŒ‰éˆ•é–‹å§‹/åœæ­¢éŒ„éŸ³
3. **æ’­æ”¾ç¢ºèª**: æ’­æ”¾éŒ„è£½çš„éŸ³é »ç¢ºèªå“è³ª
4. **é–‹å§‹è½‰éŒ„**: é»æ“Šè½‰éŒ„æŒ‰éˆ•é€²è¡ŒèªéŸ³è­˜åˆ¥
5. **æŸ¥çœ‹çµæœ**: ç²å¾—è©³ç´°çš„è½‰éŒ„çµæœå’Œæ€§èƒ½çµ±è¨ˆ

### æ€§èƒ½ç›£æ§
æ‡‰ç”¨æä¾›è©³ç´°çš„æ€§èƒ½æŒ‡æ¨™ï¼š
- **è½‰éŒ„è€—æ™‚**: æ¯«ç§’ç´šç²¾ç¢ºè¨ˆæ™‚
- **è™•ç†é€Ÿåº¦**: ç›¸å°æ–¼éŸ³é »æ™‚é•·çš„å€ç‡
- **ç³»çµ±è³‡è¨Š**: CPU æ¶æ§‹ã€åŸ·è¡Œç·’æ•¸ã€æ¨¡å‹è³‡è¨Š
- **è¨˜æ†¶é«”ä½¿ç”¨**: æ¨¡å‹è¼‰å…¥å’Œè™•ç†ç‹€æ…‹

## ğŸ› ï¸ é–‹ç™¼æŒ‡å—

### æ·»åŠ æ–°èªè¨€æ”¯æ´
```cpp
// åœ¨ native-lib.cpp ä¸­ä¿®æ”¹
wparams.language = "zh";  // ä¸­æ–‡
wparams.language = "en";  // è‹±æ–‡
wparams.language = "ja";  // æ—¥æ–‡
```

### èª¿æ•´æ€§èƒ½åƒæ•¸
```cpp
// åŸ·è¡Œç·’æ•¸èª¿æ•´
wparams.n_threads = 6;  // æ ¹æ“šè¨­å‚™èª¿æ•´

// æ¨¡å‹ç²¾åº¦æ¬Šè¡¡
wparams.single_segment = false;  // æ›´æº–ç¢º
wparams.no_context = true;       // æ›´å¿«é€Ÿ
```

### è‡ªå®šç¾©æ¨¡å‹
1. ä¸‹è¼‰æ‰€éœ€çš„ whisper æ¨¡å‹ï¼ˆ.bin æ ¼å¼ï¼‰
2. æ”¾ç½®åœ¨ `assets/models/` ç›®éŒ„
3. åœ¨ `pubspec.yaml` ä¸­è¨»å†Š asset
4. ä¿®æ”¹è¼‰å…¥è·¯å¾‘

## ğŸ› æ•…éšœæ’é™¤

### å¸¸è¦‹å•é¡Œ

**Q: è½‰éŒ„é€Ÿåº¦å¾ˆæ…¢**
A: ç¢ºä¿ä½¿ç”¨ Release ç‰ˆæœ¬ï¼š`flutter build apk --release`

**Q: æ¨¡å‹è¼‰å…¥å¤±æ•—**
A: æª¢æŸ¥ assets ç›®éŒ„æ˜¯å¦åŒ…å«æ¨¡å‹æª”æ¡ˆï¼Œç¢ºä¿ git submodule æ­£ç¢ºåˆå§‹åŒ–

**Q: éŸ³é »éŒ„è£½å¤±æ•—**
A: ç¢ºèªæ‡‰ç”¨å…·æœ‰éº¥å…‹é¢¨æ¬Šé™

**Q: ç·¨è­¯éŒ¯èª¤**
A: ç¢ºä¿ NDK ç‰ˆæœ¬æ­£ç¢ºï¼Œæª¢æŸ¥ CMakeLists.txt ä¸­çš„è·¯å¾‘

### æ€§èƒ½èª¿å„ª
- **Debug vs Release**: Release ç‰ˆæœ¬æ€§èƒ½æå‡ 30-70 å€
- **æ¨¡å‹é¸æ“‡**: Tiny æ¨¡å‹é€Ÿåº¦æœ€å¿«ï¼ŒBase æ¨¡å‹æº–ç¢ºç‡æ›´é«˜
- **åŸ·è¡Œç·’æ•¸**: æ ¹æ“šè¨­å‚™ CPU æ ¸å¿ƒæ•¸èª¿æ•´

## ğŸ“ˆ ç‰ˆæœ¬æ­·å²

### v1.0.0 (2024-06-26) - é‡å¤§çªç ´
- âœ… å¯¦ç¾æ¯«ç§’ç´šè½‰éŒ„æ€§èƒ½
- âœ… å®Œæ•´çš„ä¸­æ–‡èªéŸ³è­˜åˆ¥æ”¯æ´
- âœ… æ™ºèƒ½ç¡¬é«”å„ªåŒ–å’Œå¤šç‰ˆæœ¬ç·¨è­¯
- âœ… è©³ç´°çš„æ€§èƒ½ç›£æ§å’Œçµ±è¨ˆ
- âœ… ç¾ä»£åŒ– Flutter UI è¨­è¨ˆ
- âœ… å®Œæ•´çš„éŒ¯èª¤è™•ç†å’Œç”¨æˆ¶åé¥‹

## ğŸ¤ è²¢ç»

æ­¡è¿æäº¤ Issue å’Œ Pull Requestï¼

### é–‹ç™¼ç’°å¢ƒè¨­ç½®
1. Fork æ­¤å°ˆæ¡ˆ
2. å‰µå»ºåŠŸèƒ½åˆ†æ”¯: `git checkout -b feature/amazing-feature`
3. æäº¤è®Šæ›´: `git commit -m 'Add amazing feature'`
4. æ¨é€åˆ†æ”¯: `git push origin feature/amazing-feature`
5. æäº¤ Pull Request

## ğŸ“„ æˆæ¬Š

æœ¬å°ˆæ¡ˆæ¡ç”¨ MIT æˆæ¬Š - è©³è¦‹ [LICENSE](LICENSE) æ–‡ä»¶

## ğŸ™ è‡´è¬

- [whisper.cpp](https://github.com/ggerganov/whisper.cpp) - é«˜æ€§èƒ½ Whisper å¯¦ç¾
- [OpenAI Whisper](https://github.com/openai/whisper) - åŸå§‹ Whisper æ¨¡å‹
- Flutter å’Œ Android é–‹ç™¼ç¤¾ç¾¤

## ğŸ“ è¯ç¹«

- **å°ˆæ¡ˆä¸»é **: https://github.com/yourusername/whisper_voice_notes
- **å•é¡Œå›å ±**: https://github.com/yourusername/whisper_voice_notes/issues
- **è¨è«–å€**: https://github.com/yourusername/whisper_voice_notes/discussions

---

**âš¡ é«”é©—æ¯«ç§’ç´šèªéŸ³è½‰æ–‡å­—çš„é­…åŠ›ï¼**